clc; clear; close all

fsize = 18; % font size
set(groot, 'defaultAxesTickLabelInterpreter','latex'); 
set(groot, 'defaultLegendInterpreter','latex');

green = [0.2980 .6 0];
crimson = [220,20,60]/255; 
darkblue = [0 .2 .4];
Darkgrey = [.25 .25 .25];
darkgrey = [.35 .35 .35];
lightgrey = [.7 .7 .7];
Lightgrey = [.9 .9 .9];
VermillionRed = [156,31,46]/255;
DupontGray = [144,131,118]/255;
Azure = [53, 112, 188]/255;
purple = [178, 102, 255]/255;
orange = [255,110,0]/255;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Plot Map
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
I = imread('NAME.pgm');
figure; imagesc([0 100], [0 32], flipud(I));
hold on, colormap gray, grid on
set(gca,'ydir','normal');

TXIDS = ["203-H", "204", "203", "208", "210", "209", "212", "214", "211", "216", "213", "220", "222", "219", "221", "229", "232", "233", "236", "235", "242"];

shiftX = 12;
shiftY = 16;
scaleX = 2.5;
scaleY = 1.5;
numAPs = 14;
pathX = 0;
pathY = 2;
ccase = 2;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Ground Truth Plots - APs, WayPts
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
waypts = [[-0.6293, 0.5203]; [1.1102, 1.9021]; [3.1891, 1.2233]; [5.374, 2.2769]; [6.5902, 1.3294]; [8.0822, 2.4112]; [9.9002, 1.5493]; [11.5895, 2.3914]; [13.4513, 1.3569]; [15.3499, 2.3043]; [17.4203, 1.3578]; [19.6209, 2.174]; [20.9494, 1.401]; [23.0776, 2.2025]; [26.4347, 2.2589]; [28.1442, 0.8896]; [28.3473, 1.1217]; [25.5873, 1.4248]; [20.2417, 1.4709]; [14.9628, 1.4894]; [9.2375, 1.1509]; [5.0948, 1.6348]];
Tx = [[0, 0];[0.8, 4.7];[3.8, -1.5];[4.2, 3.2];[7.6, 4.7];[8.0, -4.0];[11.0, 1.0];[14.4, 3.2];[15.0, -1.5];[17.8, 4.7];[18.0, -1.0];[24.6, 4.0];[28.0, 1.8];[28.0, -1.5];[35.0, -1.5];[42.4, -1.5];[46.4, 2.8];[54.4, -2.5];[56.4, 5.2];[62.4, -2.5];[70.4, 1.5]];
TXIDS = TXIDS(1:numAPs);
Tx = Tx(1:numAPs,:);

plot(scaleX*waypts(:,1)+shiftX, scaleY*waypts(:,2)+shiftY-pathY,'-','color', [darkblue .7], 'LineWidth',2)
plot(scaleX*Tx(:,1)+shiftX, scaleY*Tx(:,2)+shiftY,'x', 'color', [darkblue .7], 'MarkerFaceColor', darkblue, 'MarkerSize',7,'LineWidth',2);
for AP = 1:numAPs
    str = "     NAME-"+TXIDS(AP);
    text(scaleX*Tx(AP,1)+shiftX,scaleY*Tx(AP,2)+shiftY, str,'Color',[darkblue .7],'FontSize',14);
end


if ccase == 1
    load 'trialNC.mat'
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % No Classifier Plots - APs, Path
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     mseNC = 5.858705657884737;
%     cdfNC = [0.0, 0.47211158526434227, 5.11424621612699, 6.196301346445632, 7.104581442993633, 7.66258468830261, 8.011936888528234, 13.122533603494508, 7.563686056210102, 7.076128815790319, 6.697243927154255, 6.159800226083223, 4.995783990951623, 5.457727391682872, 3.4445916920710964, 1.6046177439627247, 2.3098544267189567, 3.7723710697704873, 5.409244154678901, 8.285659025164534, 12.571814524184441];
%     TXNC = [[-25.81281417,  13.3200206 ]; [-37.77892771,  27.76646484]; [-16.35143872,   5.08956909]; [-15.31681816,  13.72129852]; [-0.41790701,  9.87048492]; [16.00593079,  3.37020973]; [43.72200302, 19.12389987]; [40.54731938,  8.20691143]; [84.82358521, 25.72638992]; [90.53444393,  4.96065991]; [-21.19099727,  18.45331796]; [-13.56839654,  -4.45039322]; [-3.73663176, 11.68318413]; [ 3.88473673, -0.2979463 ]; [10.75399962,  9.21193563]];
%     pathNC = [[-0.6293, 0.5203]; [1.2740215011744067, 1.4593225562500114]; [8.246325160877833, 0.46173054725559914]; [11.414659720202577, 0.8968345955042296]; [13.647261588968755, 0.5090590893833894]; [15.626152189292531, 1.0680732483201605]; [17.817451945146374, 0.32118993048853306]; [24.429496046849135, -0.31699245526588227]; [21.009253635175373, 1.6513207965591006]; [22.376092244591923, 1.4651209013003204]; [24.11709581463014, 1.2803271856920735]; [25.627781058930356, 0.809991653574426]; [25.873918418665287, 0.5601813343681812]; [28.495338430947445, 1.5430315960861756]; [29.41642008599008, 0.5342095193952837]; [29.58413752055648, 0.1815194670564087]; [30.329342853155676, -0.0644423189852336]; [29.01473060324846, -0.1511133694328598]; [25.49602093049078, 0.18558529754990236]; [23.13770198133215, 0.1391692504974641]; [21.74904826660864, -0.0786041288329394]; [19.316621191954905, 0.3799235907513923]];
    disp(mse)
    pathNC = path;
    TXNC = TX;
    TXNC = TXNC(1:numAPs,:);
    
    plot(scaleX*pathNC(:,1)+shiftX, scaleY*pathNC(:,2)+shiftY-pathY, '-', 'color', [VermillionRed .7], 'LineWidth',2)
    plot(scaleX*TXNC(:,1)+shiftX, scaleY*TXNC(:,2)+shiftY, 'x','color', [VermillionRed .7], 'MarkerFaceColor', VermillionRed, 'MarkerSize',7,'LineWidth',2);
    for AP = 1:length(TXNC)
        str = "     NAME-"+TXIDS(AP);
        text(scaleX*TXNC(AP,1)+shiftX,scaleY*TXNC(AP,2)+shiftY, str,'Color',[VermillionRed .7],'FontSize',14);
    end
end

if ccase == 2
    load 'trialSC.mat'
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Soft Classifier Plots - APs, Path
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     mseSC = 0.22842183671139413;
%     cdfSC = [0.0, 0.013086052918235797, 0.050644756283121185, 0.09684988042423075, 0.09527270466410015, 0.19509668241989328, 0.15664690842058998, 0.5774693774690566, 0.03660741215036785, 0.18206965162483008, 0.1232342176023067, 0.2514343136598585, 0.2141679588593923, 0.398484952740227, 0.4495579625887233, 0.35885608861164164, 0.4344001019902068, 0.385880431427856, 0.4328265435643725, 0.24242119112938929, 0.10185138239087686];
%     TXSC = [[-5.39345703,  0.32251141]; [-8.94871109, 11.78001834]; [-1.86160205, -2.69270742]; [-2.40192335,  7.57076261]; [12.38353935,  2.34068368]; [22.00914896, -1.24569304]; [38.96439501,  4.35279903]; [36.69532424, -2.22609303]; [54.91532896,  4.20564204]; [65.10075704, -3.37085622]; [3.5351142 , 9.63117632]; [ 2.22773094, -8.87318195]; [15.10051889,  5.54184888]; [16.4253069 , -2.04764057]; [21.6024452 ,  8.19941817]];
%     pathSC = [[-0.6293, 0.5203]; [1.1110812721116698, 1.915156344834756]; [3.1475217134310123, 1.2522160409628271]; [5.311408886662636, 2.2029929511522948]; [6.507798753017202, 1.2815782188778724]; [8.017978127693077, 2.226976585069536]; [9.87678922358132, 1.3944123327530455]; [12.117733023805766, 2.158074573876921]; [13.485325357708513, 1.3433952727848868]; [15.36942499192581, 2.1232802973898033]; [17.412562199403865, 1.2348089481710676]; [19.58208714342097, 1.9255794367412795]; [20.93731007238188, 1.1871735557696688]; [23.020598713782146, 1.8081129934570725]; [26.30002634044045, 1.8299881592357674]; [27.935462077097803, 0.597699037555334]; [28.121800916488326, 0.7504135715589692]; [25.44239637597971, 1.0671596120336317]; [20.07456633407754, 1.0716442492221294]; [14.855398906712166, 1.272068366156305]; [9.186657688435291, 1.0626460287030117]; [5.085325501716819, 1.5867745923472028]];
    disp(mse)
    pathSC = path;
    TXSC = TX;
    TXSC = TXSC(1:numAPs,:);
    
    plot(scaleX*pathSC(:,1)+shiftX, scaleY*pathSC(:,2)+shiftY-pathY, '-', 'color', [VermillionRed .7], 'LineWidth',2)
    plot(scaleX*TXSC(:,1)+shiftX, scaleY*TXSC(:,2)+shiftY,'x','color', [VermillionRed .7], 'MarkerFaceColor', VermillionRed, 'MarkerSize',7,'LineWidth',2);
    for AP = 1:length(TXSC)
        str = "     NAME-"+TXIDS(AP);
        text(scaleX*TXSC(AP,1)+shiftX,scaleY*TXSC(AP,2)+shiftY, str,'Color',[VermillionRed .7],'FontSize',14);
    end
end


if ccase == 3
    load 'trialHC.mat'
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Hard Classifier Plots - APs, Path
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     mseHC = 0.4403752838120727;
%     cdfHC = [0.0, 0.02648773512644154, 0.05482512790739829, 0.09054668900060071, 0.06220362396904202, 0.1725464897843429, 0.13885859439801332, 1.739018365047584, 0.10742245371000943, 0.13860411115465734, 0.2533438480178933, 0.4107888048589951, 0.42960515856520964, 0.6578066725892953, 0.8804104823591694, 0.8848173677532519, 0.9511794234916388, 0.9166994368801922, 0.6077177217857996, 0.20816476656679644, 0.5168340870871974];
%     TXHC = [[-2.81212759, -2.51461075]; [-2.4298244 ,  5.28558665]; [ 1.34783878, -4.05312603]; [3.17374465, 3.0712512 ]; [11.40775408,  0.01525844]; [22.00130632, -2.85848726]; [39.60277439, -0.22232728]; [34.2811569 , -4.02300297]; [52.40584523,  2.47672121]; [54.4, -2.5]; [5.22035028, 5.34538]; [ 7.72487539, -4.80801366]; [15.33407439,  3.07378396]; [16.70149505, -5.10810087]; [19.35652472,  4.57535348]];
%     pathHC = [[-0.6293, 0.5203]; [1.093087065866991, 1.8818824927973843]; [3.165219893672845, 1.272651141545727]; [5.2834638096773885, 2.2782788150127677]; [6.554744954360695, 1.3805099850674674]; [7.955701052749452, 2.293853046561057]; [9.800116867130798, 1.4530447364905288]; [13.199722466099002, 1.7346135174633874]; [13.426021161332008, 1.4613057655336943]; [15.231544679927815, 2.232167359402395]; [17.18050529320593, 1.4395410785471934]; [19.253009578812993, 1.9912321685954315]; [20.53078972109046, 1.3044286447381213]; [22.535609580107604, 1.8297319712638116]; [25.75829884302134, 1.6953362571227317]; [27.297173578753046, 0.6337719014897518]; [27.466559145942632, 0.7624816211993268]; [24.784275135294074, 0.9826587055697106]; [19.70289839770485, 1.1898063096818081]; [14.794043916302947, 1.3675232005054199]; [9.705196138132301, 1.3708495304641248]; [6.206690134891254, 1.7918516908750626]];
    disp(mse)
    pathHC = path;
    TXHC = TX;
    TXHC = TXHC(1:numAPs,:);
    
    plot(scaleX*pathHC(:,1)+shiftX, scaleY*pathHC(:,2)+shiftY-pathY, '-', 'color', [VermillionRed .7], 'LineWidth',2)
    plot(scaleX*TXHC(:,1)+shiftX, scaleY*TXHC(:,2)+shiftY,'x','color', [VermillionRed .7], 'MarkerFaceColor', VermillionRed, 'MarkerSize',7,'LineWidth',2);
    
    for AP = 1:length(TXHC)
        str = "     NAME-"+TXIDS(AP);
        text(scaleX*TXHC(AP,1)+shiftX,scaleY*TXHC(AP,2)+shiftY, str,'Color',[VermillionRed .7],'FontSize',14);
    end
end

set(gca,'TickLabelInterpreter','latex')
figuresize(50,20,'cm') 
legend('Ground Truth', 'AP Ground Truth', 'Localized Path', 'AP Localized', 'location', 'best', 'fontsize', 14, 'Interpreter','latex');
print -opengl -dpng -r600 exp_fs_soft_classifier.png